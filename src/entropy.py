import xlsxwriter
import pandas as pd
df = pd.read_excel('Malware_name.xlsx')
# 创建工作簿
file_name = "entropy.xlsx"
workbook = xlsxwriter.Workbook(file_name)

# 创建工作表
worksheet = workbook.add_worksheet('sheet1')
 
# 写单元格
worksheet.write(0, 0, 'malware_name')
worksheet.write(0,1, 'other_name')
worksheet.write(0,2, 'text')
worksheet.write(0,3, 'relation')
row = 1
for i in range(1,63):
    malware_name = df[df['family'] ==i].values[:,0]
    other = df[df['family'] !=i].values[:,0]
    readDir = "../text/"+str(i)+"_relation_text.txt"
    f = open(readDir,"r",encoding = 'utf-8',errors = 'ignore')
    for line in f:
        other_name = []
        line = line.strip('\n')
        for name in other:
            if name in line:
                other_name.append(name)
        worksheet.write_row(row, 0, [','.join(str(a) for a in malware_name),','.join(str(a) for a in other_name ), line])
        row+=1


# 关闭工作簿
workbook.close()